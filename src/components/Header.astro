---
import Link from '@/components/Link.astro'
import MobileMenu from '@/components/ui/mobile-menu'
import SearchButton from '@/components/react/SearchButton'
import ThemeSelector from '@/components/react/ThemeSelector'
import { NAV_LINKS } from '@/consts'
import { Icon } from 'astro-icon/components'
import { cn } from '@/lib/utils'

const isExternalLink = (href: string) => {
  return href.startsWith('http')
}
---

<header class="bg-background/80 sticky top-0 z-50 w-full border-b border-border/40 backdrop-blur-xl transition-all duration-300" transition:persist>
  <div class="mx-auto flex h-16 max-w-5xl items-center justify-between px-4 sm:px-6">
    <Link href="/" class="flex items-center gap-2 group transition-transform active:scale-95" data-astro-reload>
      <span class="brand-logo">
        Merox
      </span>
    </Link>
    
    <div class="flex items-center gap-2 md:gap-8">
      <nav class="hidden items-center gap-1 text-sm font-medium md:flex">
        {NAV_LINKS.map((item) => {
          const isExternal = isExternalLink(item.href)
          const isInsideLink = item.label.toLowerCase() === 'inside'
          return (
            <Link 
              href={item.href} 
              class={cn(
                "group relative px-3 py-2 rounded-full transition-all duration-200",
                isInsideLink 
                  ? "text-primary hover:bg-primary/5" 
                  : "text-foreground/70 hover:text-foreground hover:bg-foreground/5"
              )}
            >
              <span class="flex items-center gap-1.5">
                {item.label}
                {isExternal && (
                  <Icon 
                    name="lucide:external-link" 
                    class="size-3 opacity-60 group-hover:opacity-100 transition-opacity" 
                    aria-hidden="true"
                  />
                )}
              </span>
            </Link>
          )
        })}
      </nav>

      <div class="flex items-center gap-2">
        <div class="hidden h-5 w-px bg-border/40 md:block" aria-hidden="true"></div>
        <SearchButton client:idle />
        <div class="hidden md:flex items-center">
          <ThemeSelector client:idle />
        </div>
        <MobileMenu client:idle transition:persist />
      </div>
    </div>
  </div>
</header>